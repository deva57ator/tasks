<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Минимальный таск-трекер — MVP</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <aside class="sidebar">
    <div>
      <h2>Отображения</h2>
      <div class="nav">
        <button class="nav-btn is-active" data-view="all">Все задачи</button>
        <button class="nav-btn" data-view="today">Сегодня</button>
        <button class="nav-btn" data-view="sprint">Спринт</button>

        <div class="projects" id="projectsBlock">
          <div class="proj-header">
            <div class="proj-title">Проекты</div>
            <button class="proj-add" id="projAdd" title="Добавить проект">＋</button>
          </div>
          <div class="proj-list" id="projList"></div>
        </div>

      </div>
    </div>

    <div class="archive-access">
      <button type="button" class="archive-btn" id="archiveBtn">Архив</button>
    </div>

    <section class="calendar" id="calendar">
      <div class="cal-header">
        <button class="cal-today" id="calToday" aria-label="Текущий месяц" title="Перейти к текущему месяцу"></button>
        <div class="cal-title" id="calTitle">Месяц ГГГГ</div>
        <div class="cal-ctrls">
          <button class="cal-arrow" id="calPrev" aria-label="Предыдущий месяц">‹</button>
          <button class="cal-arrow" id="calNext" aria-label="Следующий месяц">›</button>
          <button class="cal-collapse" id="calToggle" aria-label="Свернуть календарь" aria-pressed="false" title="Свернуть календарь">▾</button>
        </div>
      </div>
      <div class="cal-legend">
        <div>Wk</div><div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>
      </div>
      <div class="cal-viewport">
        <div class="cal-track" id="calTrack">
          <div class="cal-month" id="calCurr"></div>
          <div class="cal-month" id="calNextBuf"></div>
        </div>
        <div class="cal-spacer"></div>
      </div>
    </section>

    <div class="sidebar-resizer" id="sidebarResizer" aria-hidden="true"></div>

  </aside>

  <main class="main">
    <div class="header">
      <div class="header-top">
        <div class="header-leading">
          <div class="title" id="viewTitle">Все задачи</div>
          <div class="sprint-filters" id="sprintFilters" aria-hidden="true"></div>
        </div>
        <div class="workday-bar" id="workdayBar" aria-live="polite">
          <div class="workday-stats">
            <div class="workday-stat">
              <span class="workday-stat-label">Сделано:</span>
              <span class="workday-stat-value" id="workdayDone">0</span>
            </div>
            <div class="workday-stat">
              <span class="workday-stat-label">Время сегодня:</span>
              <span class="workday-stat-value" id="workdayTime">0 мин</span>
            </div>
          </div>
          <button type="button" class="workday-finish" id="workdayFinishBtn">Завершить день</button>
        </div>
        <div class="header-actions">
          <button
            type="button"
            class="icon-btn settings-btn"
            id="apiSettingsBtn"
            aria-label="Настройки API"
            title="Настройки API"
          ></button>
          <button
            type="button"
            class="icon-btn theme-btn"
            id="themeToggle"
            aria-label="Переключить на тёмную тему"
            aria-pressed="false"
            title="Переключить на тёмную тему"
          ></button>
        </div>
      </div>
    </div>
    <div class="composer">
      <input id="taskInput" class="input" type="text" placeholder="Новая задача…" />
      <button id="addBtn" class="add-btn">Добавить</button>
    </div>
    <div class="tasks" id="tasks"></div>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>
  <div class="context-menu" id="ctxMenu" role="menu" aria-hidden="true"></div>
  <div class="context-menu" id="dueMenu" aria-hidden="true"></div>
  <div class="context-menu" id="projCtxMenu" role="menu" aria-hidden="true"></div>
  <div class="context-menu emoji-menu" id="emojiMenu" role="menu" aria-hidden="true"></div>
  <div class="ctx-submenu" id="ctxSub" aria-hidden="true"></div>

  <button id="storageToggle" class="storage-toggle" type="button" aria-live="polite" title="Переключить хранилище"></button>

  <div class="notes-overlay" id="notesOverlay" aria-hidden="true"></div>
  <aside class="notes-sidebar" id="notesSidebar" aria-hidden="true">
    <div class="notes-header">
      <div class="notes-label">Заметки</div>
      <button type="button" class="notes-close" id="notesClose" aria-label="Закрыть заметки">×</button>
    </div>
    <div class="notes-task" id="notesTaskTitle"></div>
    <textarea
      class="notes-input"
      id="notesInput"
      placeholder="Добавьте заметки для этой задачи..."
    ></textarea>
  </aside>

  <div class="time-overlay" id="timeOverlay" aria-hidden="true">
    <div class="time-dialog" role="dialog" aria-modal="true" aria-labelledby="timeDialogTitle">
      <button type="button" class="time-dialog-close" id="timeDialogClose" aria-label="Закрыть окно">×</button>
      <div class="time-dialog-header">
        <div class="time-dialog-title" id="timeDialogTitle">Затраченное время</div>
        <div class="time-dialog-subtitle" id="timeDialogSubtitle"></div>
      </div>
      <form class="time-dialog-form" id="timeDialogForm">
        <div class="time-dialog-fields">
          <label class="time-field">
            <span class="time-field-label">Часы</span>
            <input type="number" min="0" inputmode="numeric" class="time-input" id="timeInputHours" />
          </label>
          <label class="time-field">
            <span class="time-field-label">Минуты</span>
            <input type="number" min="0" inputmode="numeric" class="time-input" id="timeInputMinutes" />
          </label>
        </div>
        <div class="time-dialog-summary">Итого: <span id="timeDialogSummary">0 мин</span></div>
        <div class="time-dialog-error" id="timeDialogError" role="alert" aria-live="polite"></div>
        <div class="time-dialog-actions">
          <button type="button" class="time-dialog-secondary" id="timeDialogCancel">Отмена</button>
          <button type="submit" class="time-dialog-primary" id="timeDialogSave">Сохранить</button>
        </div>
      </form>
    </div>
  </div>

  <div class="workday-overlay" id="workdayOverlay" aria-hidden="true">
    <div class="workday-dialog" role="dialog" aria-modal="true" aria-labelledby="workdayDialogTitle">
      <button type="button" class="workday-dialog-close" id="workdayDialogClose" aria-label="Закрыть окно">×</button>
      <div class="workday-dialog-header">
        <div class="workday-dialog-title" id="workdayDialogTitle">Итоги рабочего дня</div>
        <div class="workday-dialog-range" id="workdayDialogRange"></div>
      </div>
      <div class="workday-summary">
        <div class="workday-summary-item">
          <div class="workday-summary-label">Затраченное время</div>
          <div class="workday-summary-value" id="workdaySummaryTime">0 мин</div>
        </div>
        <div class="workday-summary-item">
          <div class="workday-summary-label">Закрыто задач</div>
          <div class="workday-summary-value" id="workdaySummaryDone">0</div>
        </div>
      </div>
      <div class="workday-dialog-section" id="workdayCompletedSection">
        <div class="workday-dialog-subtitle">Закрытые задачи на сегодня</div>
        <div class="workday-dialog-empty" id="workdayDialogCompletedEmpty">Сегодня ещё нет закрытых задач.</div>
        <ul class="workday-dialog-list" id="workdayCompletedList" aria-live="polite"></ul>
      </div>
      <div class="workday-dialog-section">
        <div class="workday-dialog-subtitle">Незакрытые задачи на сегодня</div>
        <div class="workday-dialog-empty" id="workdayDialogEmpty">Все задачи закрыты — отличный результат!</div>
        <ul class="workday-dialog-list" id="workdayPendingList" aria-live="polite"></ul>
      </div>
      <div class="workday-dialog-actions">
        <button type="button" class="workday-dialog-action" id="workdayPostponeBtn">Перенести на следующий день</button>
        <button type="button" class="workday-dialog-secondary" id="workdayDialogDone">На сегодня всё!</button>
      </div>
    </div>
  </div>

  <div class="api-settings-overlay" id="apiSettingsOverlay" aria-hidden="true">
    <div class="api-settings-dialog" id="apiSettingsDialog" role="dialog" aria-modal="true" aria-labelledby="apiSettingsTitle">
      <button type="button" class="api-settings-close" id="apiSettingsClose" aria-label="Закрыть окно">×</button>
      <div class="api-settings-header">
        <div class="api-settings-title" id="apiSettingsTitle">Настройки API</div>
        <div class="api-settings-description">Укажите ключ и базовый URL для запросов.</div>
      </div>
      <form class="api-settings-form" id="apiSettingsForm">
        <label class="api-settings-field">
          <span class="api-settings-label">API ключ</span>
          <input type="text" class="api-settings-input" id="apiSettingsKey" placeholder="Введите ключ" autocomplete="off" />
        </label>
        <label class="api-settings-field">
          <span class="api-settings-label">Base URL API</span>
          <input type="text" class="api-settings-input" id="apiSettingsBase" placeholder="/tasks/api" autocomplete="off" />
        </label>
        <div class="api-settings-error" id="apiSettingsError" role="alert" aria-live="polite"></div>
        <div class="api-settings-actions">
          <button type="button" class="api-settings-secondary" id="apiSettingsCancel">Отмена</button>
          <button type="submit" class="api-settings-primary" id="apiSettingsSave">Сохранить</button>
        </div>
      </form>
    </div>
  </div>

  <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
  <script src="main.js" defer></script>
</body>
</html>
